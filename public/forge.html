<!DOCTYPE html>
<html lang="en">
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WHLSLX6VL3"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ window.dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-WHLSLX6VL3');
</script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="theme-color" content="#08090b">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="icon" type="image/jpeg" href="/images/clawbeat-icon-claw-logo-32x32.ico">
  <link rel="apple-touch-icon" href="/images/clawbeat-icon-claw-logo-32x32.ico">
  <title>Forge â€” ClawBeat Â· Build Dispatch</title>
  <meta name="description" content="OpenClaw open-source GitHub repositories, analytics, and ecosystem intelligence tracked by ClawBeat.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,400;0,500;0,700;1,400&family=Space+Grotesk:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { -webkit-text-size-adjust: 100%; font-size: 16px; }

    :root {
      --bg: #08090b;
      --bg-2: #0d0f12;
      --bg-3: #131619;
      --border: rgba(255,255,255,0.05);
      --border-2: rgba(255,255,255,0.09);
      --orange: #f97316;
      --orange-bright: #fb923c;
      --orange-dim: rgba(249,115,22,0.10);
      --orange-glow: rgba(249,115,22,0.18);
      --green: #22c55e;
      --green-dim: rgba(34,197,94,0.08);
      --cyan: #06b6d4;
      --cyan-dim: rgba(6,182,212,0.08);
      --blue: #3b82f6;
      --blue-dim: rgba(59,130,246,0.08);
      --amber: #f59e0b;
      --amber-dim: rgba(245,158,11,0.08);
      --purple: #a78bfa;
      --purple-dim: rgba(167,139,250,0.08);
      --text: #e2e4e9;      /* contrast >7:1 on --bg-2 */
      --text-2: #9097a3;    /* contrast ~6.8:1 on --bg-2 â€” AA pass */
      --text-3: #6e7680;    /* contrast ~4.5:1 on --bg-2 â€” AA pass for UI labels */
      --text-4: #3d4451;    /* decorative only â€” dividers, ornaments */
      --mono: 'JetBrains Mono', monospace;
      --sans: 'Space Grotesk', sans-serif;
      --min-font: 12px;     /* global floor */
    }

    body { font-family: var(--sans); background: var(--bg); color: var(--text); min-height: 100vh; overflow-x: hidden; }

    /* â”€â”€ ACCESSIBILITY â”€â”€ */
    .skip-link {
      position: absolute; top: -999px; left: 1rem; z-index: 9999;
      padding: 0.5rem 1rem;
      background: var(--orange); color: #000;
      font-family: var(--mono); font-size: 14px; font-weight: 700;
      border-radius: 4px; text-decoration: none;
    }
    .skip-link:focus { top: 1rem; }

    /* Visible focus ring for all interactive elements */
    :focus-visible {
      outline: 2px solid var(--orange);
      outline-offset: 3px;
      border-radius: 3px;
    }

    /* â”€â”€ SCROLLBAR â”€â”€ */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: var(--bg); }
    ::-webkit-scrollbar-thumb { background: #27272a; border-radius: 3px; }

    /* â”€â”€ HEADER â”€â”€ */
    .header {
      position: sticky; top: 0; z-index: 50;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      background: rgba(10,10,12,0.88);
      backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px);
    }
    .header-inner {
      max-width: 72rem; margin: 0 auto; padding: 0 1.5rem;
      height: 4rem; display: flex; align-items: center; justify-content: space-between; gap: 1rem;
    }
    .brand { display: flex; align-items: center; gap: 0.75rem; text-decoration: none; }
    .brand-img { width: 40px; height: 40px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); overflow: hidden; }
    .brand-img img { width: 100%; height: 100%; object-fit: cover; }
    .brand-text { font-family: var(--sans); font-size: 1.25rem; font-weight: 900; text-transform: uppercase; letter-spacing: -0.05em; font-style: italic; color: #fff; }
    .brand-text span { color: var(--orange); }
    .header-nav { display: flex; align-items: center; gap: 0.25rem; }
    .nav-item {
      font-family: var(--sans); font-size: 0.625rem; font-weight: 900; letter-spacing: 0.1em;
      text-transform: uppercase; color: #64748b; padding: 0.375rem 1rem; border-radius: 0.375rem;
      text-decoration: none; transition: all 0.15s; display: flex; align-items: center; gap: 0.75rem;
    }
    .nav-item svg { width: 16px; height: 16px; flex-shrink: 0; }
    .nav-item:hover { color: #cbd5e1; background: rgba(255,255,255,0.05); }
    .nav-item[aria-current="page"] { background: rgba(255,255,255,0.1); color: var(--orange); box-shadow: inset 0 0 10px rgba(249,115,22,0.1); }

    /* â”€â”€ HAMBURGER / MOBILE MENU â”€â”€ */
    .hamburger-btn { display: none; padding: 0.5rem; color: #94a3b8; background: transparent; border: none; cursor: pointer; align-items: center; justify-content: center; border-radius: 4px; }
    .hamburger-btn:hover { color: #fff; }
    .hamburger-btn svg { width: 24px; height: 24px; }
    .mobile-menu {
      display: none; position: absolute; top: 4rem; left: 0; width: 100%;
      background: rgba(10,10,12,0.97); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
      border-bottom: 1px solid rgba(255,255,255,0.1); padding: 1rem;
      flex-direction: column; gap: 0.5rem; z-index: 60;
    }
    .mobile-menu.open { display: flex; }
    .mobile-nav-item {
      font-family: var(--sans); font-size: 0.75rem; font-weight: 900; letter-spacing: 0.1em;
      text-transform: uppercase; color: #64748b; padding: 0.75rem 1rem; border-radius: 0.375rem;
      text-decoration: none; transition: all 0.15s; display: flex; align-items: center; gap: 0.75rem; width: 100%;
    }
    .mobile-nav-item:hover { color: #cbd5e1; background: rgba(255,255,255,0.05); }
    .mobile-nav-item[aria-current="page"] { background: rgba(255,255,255,0.1); color: var(--orange); box-shadow: inset 0 0 10px rgba(249,115,22,0.1); }
    .mobile-nav-item svg { width: 16px; height: 16px; flex-shrink: 0; }
    @media (max-width: 768px) { .header-nav { display: none; } .hamburger-btn { display: flex; } }

    /* â”€â”€ PINNED REPO (always first, below header) â”€â”€ */
    .pinned-section {
      background: var(--bg-2);
      border-bottom: 1px solid rgba(249,115,22,0.18);
    }
    .pinned-inner {
      max-width: 72rem; margin: 0 auto; padding: 1rem 1.5rem;
    }
    .pinned-lbl {
      font-family: var(--mono); font-size: var(--min-font); font-weight: 700;
      letter-spacing: 0.25em; text-transform: uppercase; color: var(--orange);
      display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.65rem;
    }
    .pinned-lbl::before { content: 'ğŸ“Œ'; font-size: 12px; }
    .pinned-card {
      display: flex; align-items: flex-start; gap: 1.5rem; flex-wrap: wrap;
    }
    .pinned-left { flex: 1; min-width: 0; }
    .pinned-name {
      font-family: var(--sans); font-size: 1.15rem; font-weight: 800;
      color: #fff; letter-spacing: -0.03em; line-height: 1.25; margin-bottom: 0.3rem;
    }
    .pinned-name a { color: inherit; text-decoration: none; transition: color 0.15s; }
    .pinned-name a:hover { color: var(--orange); }
    .owner-text { color: var(--text-3); font-weight: 600; }
    .slash-text { color: var(--text-4); }
    .pinned-desc { font-size: 14px; color: var(--text-2); line-height: 1.6; margin-bottom: 0.65rem; }
    .pinned-meta { display: flex; align-items: center; gap: 1rem; flex-wrap: wrap; }
    .pmeta { font-family: var(--mono); font-size: var(--min-font); color: var(--text-3); display: flex; align-items: center; gap: 0.3rem; }
    .pmeta strong { color: var(--text-2); font-weight: 500; }
    .pinned-right { display: flex; flex-direction: column; align-items: flex-end; gap: 0.6rem; flex-shrink: 0; }
    .pinned-stars {
      font-family: var(--mono); font-size: 1.1rem; font-weight: 700; color: var(--orange);
      display: flex; align-items: center; gap: 0.35rem; white-space: nowrap;
    }
    .pinned-badges { display: flex; align-items: center; gap: 0.4rem; flex-wrap: wrap; justify-content: flex-end; }

    /* â”€â”€ PAGE HERO â”€â”€ */
    .page-hero { max-width: 72rem; margin: 0 auto; padding: 2rem 1.5rem 1.5rem; }
    .hero-path {
      font-family: var(--mono); font-size: var(--min-font); color: var(--text-3);
      display: flex; align-items: center; gap: 0.3rem; margin-bottom: 0.65rem;
    }
    .path-sep { color: var(--text-4); }
    .path-current { color: var(--orange); }
    .hero-row { display: flex; align-items: flex-end; justify-content: space-between; gap: 1.5rem; }
    .hero-title { font-family: var(--sans); font-size: 2.25rem; font-weight: 900; letter-spacing: -0.05em; line-height: 1.1; color: #fff; text-transform: uppercase; font-style: italic; }
    .hero-title em { color: var(--orange); font-style: italic; }
    .hero-stats { display: flex; flex-direction: column; align-items: flex-end; gap: 0.35rem; flex-shrink: 0; }
    .hero-stat { font-family: var(--mono); font-size: var(--min-font); color: var(--text-3); display: flex; align-items: center; gap: 0.4rem; }
    .hero-stat strong { font-weight: 600; }
    .val-orange { color: var(--orange); }
    .val-cyan   { color: var(--cyan); }

    /* Language legend */
    .legend { display: flex; align-items: center; gap: 1.25rem; flex-wrap: wrap; padding: 0.85rem 0 0; }
    .legend-item { display: flex; align-items: center; gap: 0.35rem; font-family: var(--mono); font-size: var(--min-font); color: var(--text-2); }
    .legend-pip { width: 3px; height: 14px; border-radius: 2px; flex-shrink: 0; }

    /* â”€â”€ FILTER BAR (language only) â”€â”€ */
    .filter-bar-wrap {
      border-top: 1px solid var(--border-2); border-bottom: 1px solid var(--border-2);
      background: var(--bg-2); overflow-x: auto; scrollbar-width: none;
    }
    .filter-bar-wrap::-webkit-scrollbar { display: none; }
    .filter-bar { max-width: 72rem; margin: 0 auto; padding: 0 1.5rem; display: flex; align-items: stretch; }
    .filter-group-label {
      font-family: var(--mono); font-size: var(--min-font); color: var(--text-3);
      text-transform: uppercase; letter-spacing: 0.12em;
      padding: 0 0.75rem; display: flex; align-items: center;
      border-right: 1px solid var(--border); white-space: nowrap; flex-shrink: 0;
    }
    .filter-tab {
      font-family: var(--mono); font-size: var(--min-font); font-weight: 700;
      letter-spacing: 0.08em; text-transform: uppercase; color: var(--text-3);
      padding: 0.6rem 0.9rem; border: none; background: transparent;
      cursor: pointer; transition: all 0.15s; white-space: nowrap;
      border-bottom: 2px solid transparent; flex-shrink: 0;
    }
    .filter-tab:hover { color: var(--text); background: rgba(255,255,255,0.03); }
    .filter-tab.active { color: var(--orange); border-bottom-color: var(--orange); background: var(--orange-dim); }
    .filter-tab .tab-count { font-size: var(--min-font); color: var(--text-3); margin-left: 0.25rem; font-weight: 400; }
    .filter-tab.active .tab-count { color: rgba(249,115,22,0.6); }

    /* â”€â”€ MAIN CONTAINER â”€â”€ */
    .main-container { max-width: 72rem; margin: 0 auto; padding: 0 1.5rem 5rem; }

    /* â”€â”€ SECTION DIVIDER â”€â”€ */
    .section-divider { display: flex; align-items: center; gap: 0.75rem; margin: 2.25rem 0 1.25rem; }
    .sdl { font-family: var(--mono); font-size: var(--min-font); font-weight: 700; color: var(--text-3); white-space: nowrap; display: flex; align-items: center; gap: 0.35rem; }
    .sdl-slash { color: var(--text-4); }
    .sdl-tag   { color: var(--orange); }
    .sdl-line  { flex: 1; height: 1px; background: linear-gradient(to right, var(--border-2), transparent); }
    .sdl-count { font-family: var(--mono); font-size: var(--min-font); color: var(--text-3); white-space: nowrap; }

    /* â”€â”€ ANALYTICS METRICS â”€â”€ */
    .metrics-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.75rem; margin-bottom: 1rem; }
    .metric-chip { background: var(--bg-2); border: 1px solid var(--border-2); border-radius: 8px; padding: 1rem 1.1rem; }
    .metric-label { font-family: var(--mono); font-size: var(--min-font); color: var(--text-3); text-transform: uppercase; letter-spacing: 0.12em; margin-bottom: 0.4rem; }
    .metric-value { font-family: var(--mono); font-size: 1.5rem; font-weight: 700; line-height: 1; }
    .mv-orange { color: var(--orange); }
    .mv-cyan   { color: var(--cyan); }
    .mv-green  { color: var(--green); }
    .metric-sub { font-family: var(--mono); font-size: var(--min-font); color: var(--text-3); margin-top: 0.3rem; }

    /* â”€â”€ CHARTS â”€â”€ */
    .charts-grid { display: grid; grid-template-columns: 1fr 240px; gap: 0.75rem; margin-bottom: 0.75rem; }
    .chart-panel { background: var(--bg-2); border: 1px solid var(--border-2); border-radius: 8px; padding: 1.1rem 1.25rem; }
    .chart-panel-full { background: var(--bg-2); border: 1px solid var(--border-2); border-radius: 8px; padding: 1.1rem 1.25rem; margin-bottom: 0.75rem; }
    .cph {
      font-family: var(--mono); font-size: var(--min-font); color: var(--text-3);
      text-transform: uppercase; letter-spacing: 0.2em; margin-bottom: 0.75rem;
      display: flex; align-items: center; justify-content: space-between; gap: 0.5rem;
    }
    .cph::before { content: '// '; color: var(--text-4); white-space: pre; }
    .cph-note { font-size: var(--min-font); color: var(--text-3); font-weight: 400; letter-spacing: 0; text-transform: none; }

    /* â”€â”€ CHART WINDOW TABS â”€â”€ */
    .win-tabs { display: flex; align-items: center; gap: 0.2rem; }
    .win-tab {
      font-family: var(--mono); font-size: var(--min-font); font-weight: 700;
      letter-spacing: 0.06em; text-transform: uppercase; color: var(--text-3);
      padding: 0.15rem 0.45rem; border: 1px solid var(--border); background: transparent;
      border-radius: 3px; cursor: pointer; transition: all 0.15s; white-space: nowrap;
    }
    .win-tab:hover { color: var(--text); border-color: var(--border-2); background: rgba(255,255,255,0.03); }
    .win-tab.active { color: var(--orange); border-color: rgba(249,115,22,0.35); background: var(--orange-dim); }

    /* Daily chart legend */
    .daily-legend { display: flex; align-items: center; gap: 1.25rem; flex-wrap: wrap; margin-top: 0.75rem; }
    .daily-leg-item { display: flex; align-items: center; gap: 0.4rem; font-family: var(--mono); font-size: var(--min-font); color: var(--text-2); }
    .daily-leg-bar { width: 12px; height: 10px; border-radius: 2px; }
    .daily-leg-line { width: 20px; height: 2px; border-radius: 1px; }
    .daily-leg-dash { width: 20px; height: 0; border-top: 2px dashed; }

    /* â”€â”€ BADGES â”€â”€ */
    .badge {
      font-family: var(--mono); font-size: var(--min-font); font-weight: 700;
      letter-spacing: 0.08em; text-transform: uppercase; border-radius: 3px;
      padding: 0.2rem 0.5rem; display: inline-flex; align-items: center; gap: 0.25rem; white-space: nowrap;
    }
    .badge-public    { color: var(--green);  background: var(--green-dim);  border: 1px solid rgba(34,197,94,0.2); }
    .badge-topic     { color: var(--text-3); background: rgba(255,255,255,0.03); border: 1px solid var(--border); }
    .badge-lang-python     { color: var(--blue);   background: var(--blue-dim);   border: 1px solid rgba(59,130,246,0.2); }
    .badge-lang-typescript { color: var(--cyan);   background: var(--cyan-dim);   border: 1px solid rgba(6,182,212,0.2); }
    .badge-lang-javascript { color: var(--amber);  background: var(--amber-dim);  border: 1px solid rgba(245,158,11,0.2); }
    .badge-lang-rust       { color: var(--orange); background: var(--orange-dim); border: 1px solid rgba(249,115,22,0.2); }
    .badge-lang-go         { color: var(--green);  background: var(--green-dim);  border: 1px solid rgba(34,197,94,0.2); }
    .badge-lang-mdx,
    .badge-lang-other      { color: var(--purple); background: var(--purple-dim); border: 1px solid rgba(167,139,250,0.2); }
    .badge-lang-undetected { color: var(--text-3); background: rgba(255,255,255,0.03); border: 1px solid var(--border-2); }
    .badge-lang-c,
    .badge-lang-cpp        { color: #60a5fa; background: rgba(96,165,250,0.08);   border: 1px solid rgba(96,165,250,0.2); }
    .badge-lang-csharp     { color: #c084fc; background: rgba(192,132,252,0.08);  border: 1px solid rgba(192,132,252,0.2); }
    .badge-lang-shell,
    .badge-lang-bash,
    .badge-lang-sh         { color: #4ade80; background: rgba(74,222,128,0.08);   border: 1px solid rgba(74,222,128,0.2); }
    .badge-lang-java       { color: #fb923c; background: rgba(251,146,60,0.08);   border: 1px solid rgba(251,146,60,0.2); }
    .badge-lang-kotlin     { color: #e879f9; background: rgba(232,121,249,0.08);  border: 1px solid rgba(232,121,249,0.2); }
    .badge-lang-swift      { color: #ff6b6b; background: rgba(255,107,107,0.08);  border: 1px solid rgba(255,107,107,0.2); }
    .badge-lang-ruby       { color: #f43f5e; background: rgba(244,63,94,0.08);    border: 1px solid rgba(244,63,94,0.2); }
    .badge-lang-php        { color: #818cf8; background: rgba(129,140,248,0.08);  border: 1px solid rgba(129,140,248,0.2); }
    .badge-lang-html       { color: #f87171; background: rgba(248,113,113,0.08);  border: 1px solid rgba(248,113,113,0.2); }
    .badge-lang-css        { color: #a78bfa; background: rgba(167,139,250,0.08);  border: 1px solid rgba(167,139,250,0.2); }
    .badge-lang-dockerfile { color: #38bdf8; background: rgba(56,189,248,0.08);   border: 1px solid rgba(56,189,248,0.2); }
    .badge-lang-jupyter    { color: #facc15; background: rgba(250,204,21,0.08);   border: 1px solid rgba(250,204,21,0.2); }
    .btn-gh {
      font-family: var(--mono); font-size: var(--min-font); font-weight: 700;
      letter-spacing: 0.06em; text-transform: uppercase;
      color: #000; background: var(--orange); border: none; border-radius: 5px;
      padding: 0.5rem 1rem; cursor: pointer; text-decoration: none;
      display: inline-flex; align-items: center; gap: 0.4rem; transition: background 0.15s; white-space: nowrap;
    }
    .btn-gh:hover { background: var(--orange-bright); }

    /* â”€â”€ REPO INDEX TABLE â”€â”€ */
    .table-wrap { border-radius: 8px; overflow: hidden; border: 1px solid var(--border-2); }
    .table-scroll { overflow-x: auto; }
    .rtable {
      width: 100%; border-collapse: collapse;
      font-family: var(--mono); font-size: var(--min-font);
      table-layout: fixed;
    }
    .rtable caption {
      font-family: var(--mono); font-size: var(--min-font); color: var(--text-3);
      padding: 0.6rem 1rem; text-align: left; caption-side: top;
      background: var(--bg-3); border-bottom: 1px solid var(--border-2);
    }
    .rtable thead { position: sticky; top: 0; z-index: 2; }
    .rtable th {
      background: var(--bg-3); color: var(--text-3); font-weight: 700;
      text-transform: uppercase; letter-spacing: 0.1em; font-size: var(--min-font);
      padding: 0; text-align: left; border-bottom: 1px solid var(--border-2); white-space: nowrap;
    }
    /* Sort button inside th */
    .sort-th-btn {
      display: flex; align-items: center; gap: 0.3rem; width: 100%;
      padding: 0.65rem 1rem; background: none; border: none;
      color: inherit; font: inherit; text-transform: inherit; letter-spacing: inherit;
      cursor: pointer; transition: color 0.15s; white-space: nowrap;
    }
    .sort-th-btn:hover { color: var(--text); background: rgba(255,255,255,0.04); }
    .sort-th-btn.active { color: var(--orange); }
    .sort-arrow { color: var(--orange); font-size: 13px; }

    .rtable td { padding: 0.6rem 1rem; border-bottom: 1px solid var(--border); color: var(--text-2); vertical-align: top; }
    .rtable tr:last-child td { border-bottom: none; }
    .rtable tr:hover td { background: rgba(255,255,255,0.02); }

    /* Column widths */
    .col-rank { width: 44px; }
    .col-repo { width: auto; }      /* takes remaining space */
    .col-stars { width: 80px; }
    .col-lang { width: 130px; }
    .col-topics { width: 160px; }
    .col-date { width: 110px; }
    .col-link { width: 46px; }

    .td-rank { color: var(--text-4); font-size: var(--min-font); }
    .td-repo { color: var(--text); font-weight: 600; word-break: break-word; }
    .td-repo a { color: inherit; text-decoration: none; transition: color 0.15s; }
    .td-repo a:hover { color: var(--orange); }
    .td-owner-dim { color: var(--text-3); font-weight: 400; }
    .td-desc-inline { display: block; margin-top: 0.3rem; color: var(--text-2); font-size: var(--min-font); font-weight: 400; line-height: 1.5; }
    .td-stars { color: var(--orange); white-space: nowrap; font-weight: 600; }
    .td-date { color: var(--text-3); white-space: nowrap; }
    .td-link a {
      color: var(--text-3); text-decoration: none; display: inline-flex; align-items: center;
      padding: 0.2rem; border-radius: 3px; transition: color 0.15s;
    }
    .td-link a:hover { color: var(--orange); }
    .td-link svg { width: 13px; height: 13px; }
    .td-topics { display: flex; flex-wrap: wrap; gap: 0.25rem; }
    .lang-dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; flex-shrink: 0; }
    .dot-python     { background: var(--blue); }
    .dot-typescript { background: var(--cyan); }
    .dot-javascript { background: var(--amber); }
    .dot-rust       { background: var(--orange); }
    .dot-go         { background: var(--green); }
    .dot-mdx, .dot-other { background: var(--purple); }
    .dot-undetected { background: var(--text-4); }
    .dot-c, .dot-cpp    { background: #60a5fa; }
    .dot-csharp         { background: #c084fc; }
    .dot-shell, .dot-bash, .dot-sh { background: #4ade80; }
    .dot-java           { background: #fb923c; }
    .dot-kotlin         { background: #e879f9; }
    .dot-swift          { background: #ff6b6b; }
    .dot-ruby           { background: #f43f5e; }
    .dot-php            { background: #818cf8; }
    .dot-html           { background: #f87171; }
    .dot-css            { background: #a78bfa; }
    .dot-dockerfile     { background: #38bdf8; }
    .dot-jupyter        { background: #facc15; }

    /* â”€â”€ PAGINATION â”€â”€ */
    .pagination {
      display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 0.75rem;
      padding: 0.75rem 1rem; background: var(--bg-3); border-top: 1px solid var(--border-2);
    }
    .page-btn {
      font-family: var(--mono); font-size: var(--min-font); font-weight: 700;
      letter-spacing: 0.06em; text-transform: uppercase;
      color: var(--orange); background: var(--orange-dim);
      border: 1px solid rgba(249,115,22,0.25); border-radius: 4px;
      padding: 0.4rem 0.85rem; cursor: pointer; transition: all 0.15s; white-space: nowrap;
    }
    .page-btn:hover:not(:disabled) { background: var(--orange-glow); }
    .page-btn:disabled { opacity: 0.3; cursor: not-allowed; }
    .page-info { font-family: var(--mono); font-size: var(--min-font); color: var(--text-2); text-align: center; flex: 1; }
    .page-info em { color: var(--orange); font-style: normal; }

    /* â”€â”€ EMPTY STATE â”€â”€ */
    .empty-state { text-align: center; padding: 3rem 1.5rem; font-family: var(--mono); font-size: 14px; color: var(--text-3); }

    /* â”€â”€ FOOTER â”€â”€ */
    .footer { border-top: 1px solid var(--border-2); background: var(--bg-2); padding: 1.25rem 1.5rem; }
    .footer-inner { max-width: 72rem; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; gap: 1rem; }
    .footer-brand { font-family: var(--sans); font-size: 0.875rem; font-weight: 900; text-transform: uppercase; letter-spacing: -0.03em; font-style: italic; color: #fff; }
    .footer-brand span { color: var(--orange); }

    /* â”€â”€ RESPONSIVE â”€â”€ */
    @media (max-width: 1100px) {
      /* no desc column overrides needed */
    }
    @media (max-width: 900px) {
      .charts-grid { grid-template-columns: 1fr; }
      .metrics-row { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 640px) {
      .header-inner, .main-container, .page-hero, .footer, .pinned-inner { padding-left: 1rem; padding-right: 1rem; }
      .filter-bar { padding-left: 1rem; padding-right: 1rem; }
      .hero-row { flex-direction: column; align-items: flex-start; gap: 0.75rem; }
      .hero-stats { align-items: flex-start; flex-direction: row; flex-wrap: wrap; gap: 0.6rem; }
      .footer-inner { flex-direction: column; align-items: flex-start; gap: 0.4rem; }
      .metrics-row { grid-template-columns: repeat(2, 1fr); gap: 0.5rem; }
      .pinned-right { flex-direction: row; align-items: center; }
      .pinned-card { gap: 0.75rem; }
      /* Hide less-critical table columns on mobile */
      .col-topics, .col-lang, .col-link { display: none; }
      .td-desc-inline { display: none; }
    }
    @media (max-width: 480px) {
      .metric-value { font-size: 1.25rem; }
      .pagination { flex-direction: column; align-items: stretch; text-align: center; }
      .page-btn { text-align: center; }
    }
  </style>
</head>
<body>

<!-- â”€â”€ SKIP LINK (accessibility) â”€â”€ -->
<a class="skip-link" href="#main-content">Skip to main content</a>

<!-- â”€â”€ HEADER â”€â”€ -->
<header class="header">
  <div class="header-inner">
    <a href="/?tab=news" class="brand" aria-label="ClawBeat home">
      <div class="brand-img">
        <img src="/images/clawbeat-icon-claw-logo-512x512.jpg" alt="" role="presentation" onerror="this.style.background='#131619'">
      </div>
      <span class="brand-text" aria-hidden="true">ClawBeat<span>.co</span></span>
    </a>
    <nav class="header-nav" aria-label="Primary navigation">
      <a href="/?tab=news"            class="nav-item"><i data-lucide="newspaper" aria-hidden="true"></i>Intel</a>
      <a href="/research.html"        class="nav-item"><i data-lucide="book-open" aria-hidden="true"></i>Research</a>
      <a href="/media.html"           class="nav-item"><i data-lucide="video" aria-hidden="true"></i>Media</a>
      <a href="/forge.html"           class="nav-item" aria-current="page"><i data-lucide="github" aria-hidden="true"></i>Forge</a>
      <a href="/events-calendar.html" class="nav-item"><i data-lucide="calendar" aria-hidden="true"></i>Events</a>
    </nav>
    <button class="hamburger-btn" id="hamburger-btn" onclick="toggleMenu()" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="mobile-menu">
      <span id="icon-menu" aria-hidden="true"><i data-lucide="menu"></i></span>
      <span id="icon-close" style="display:none" aria-hidden="true"><i data-lucide="x"></i></span>
    </button>
  </div>
</header>

<!-- â”€â”€ MOBILE MENU â”€â”€ -->
<nav class="mobile-menu" id="mobile-menu" aria-label="Mobile navigation" aria-hidden="true">
  <a href="/?tab=news"            class="mobile-nav-item"><i data-lucide="newspaper" aria-hidden="true"></i>Intel Feed</a>
  <a href="/research.html"        class="mobile-nav-item"><i data-lucide="book-open" aria-hidden="true"></i>Research</a>
  <a href="/media.html"           class="mobile-nav-item"><i data-lucide="video" aria-hidden="true"></i>Media Lab</a>
  <a href="/forge.html"           class="mobile-nav-item" aria-current="page"><i data-lucide="github" aria-hidden="true"></i>The Forge</a>
  <a href="/events-calendar.html" class="mobile-nav-item"><i data-lucide="calendar" aria-hidden="true"></i>Events</a>
</nav>

<!-- â”€â”€ PAGE HERO â”€â”€ -->
<div class="page-hero">
  <div class="hero-row">
    <h1 class="hero-title">Build <em>Dispatch</em></h1>
    <div class="hero-stats" id="hero-stats" aria-live="polite">
      <div class="hero-stat"><span>loading</span><strong class="val-orange">â€”</strong></div>
    </div>
  </div>
  <div class="legend" aria-label="Language color key" role="list">
    <div class="legend-item" role="listitem"><div class="legend-pip" style="background:var(--blue)" aria-hidden="true"></div><span>Python</span></div>
    <div class="legend-item" role="listitem"><div class="legend-pip" style="background:var(--cyan)" aria-hidden="true"></div><span>TypeScript</span></div>
    <div class="legend-item" role="listitem"><div class="legend-pip" style="background:var(--orange)" aria-hidden="true"></div><span>Rust</span></div>
    <div class="legend-item" role="listitem"><div class="legend-pip" style="background:var(--green)" aria-hidden="true"></div><span>Go</span></div>
    <div class="legend-item" role="listitem"><div class="legend-pip" style="background:var(--amber)" aria-hidden="true"></div><span>JavaScript</span></div>
    <div class="legend-item" role="listitem"><div class="legend-pip" style="background:var(--text-4)" aria-hidden="true"></div><span>Undetected</span></div>
  </div>
</div>

<!-- â”€â”€ LANGUAGE FILTER BAR â”€â”€ -->
<div class="filter-bar-wrap">
  <div class="filter-bar" role="toolbar" aria-label="Filter repositories by language">
    <div class="filter-group-label" aria-hidden="true">lang</div>
    <div id="lang-tabs" style="display:contents"></div>
  </div>
</div>

<!-- â”€â”€ MAIN CONTENT â”€â”€ -->
<main class="main-container" id="main-content">

  <!-- Pinned repo -->
  <section class="pinned-section" aria-label="Pinned repository" id="pinned-section">
    <div class="pinned-inner">
      <div class="pinned-lbl" aria-hidden="true">Pinned Â· openclaw/openclaw</div>
      <div class="pinned-card" id="pinned-card">
        <div class="pinned-left" style="font-family:var(--mono);font-size:var(--min-font);color:var(--text-3)">Loadingâ€¦</div>
      </div>
    </div>
  </section>

  <!-- Analytics -->
  <div class="section-divider" aria-hidden="true">
    <div class="sdl"><span class="sdl-slash">//</span> <span class="sdl-tag">ecosystem_intel</span></div>
    <div class="sdl-line"></div>
    <div class="sdl-count" id="intel-count">â€” repos indexed</div>
  </div>

  <div id="metrics-section" aria-live="polite"></div>

  <div class="charts-grid">
    <div class="chart-panel" role="figure" aria-label="Stars by repository chart">
      <div class="cph" aria-hidden="true">Stars by Repository</div>
      <div style="position:relative;height:280px"><canvas id="chart-stars" aria-label="Horizontal bar chart showing star counts for the top 8 repositories" role="img"></canvas></div>
    </div>
    <div class="chart-panel" role="figure" aria-label="Language distribution chart">
      <div class="cph" aria-hidden="true">Language Split</div>
      <div style="position:relative;height:280px"><canvas id="chart-lang" aria-label="Doughnut chart showing repository count by programming language" role="img"></canvas></div>
    </div>
  </div>

  <div class="chart-panel-full" role="figure" aria-label="Monthly build activity chart">
    <div class="cph" aria-hidden="true">
      Monthly Build Activity
      <div class="win-tabs" role="group" aria-label="Chart time window">
        <button class="win-tab active" data-days="7"  onclick="setWindow(7)"  aria-pressed="true">7D</button>
        <button class="win-tab" data-days="30" onclick="setWindow(30)" aria-pressed="false">30D</button>
        <button class="win-tab" data-days="60" onclick="setWindow(60)" aria-pressed="false">60D</button>
        <button class="win-tab" data-days="90" onclick="setWindow(90)" aria-pressed="false">90D</button>
      </div>
    </div>
    <div style="position:relative;height:140px"><canvas id="chart-monthly" aria-label="Bar chart showing number of repositories created each month" role="img"></canvas></div>
  </div>

  <!-- Daily additions chart -->
  <div class="chart-panel-full" role="figure" aria-label="Daily new repositories chart with trend line">
    <div class="cph">
      Daily New Repos
      <span class="cph-note" id="daily-win-note">7-day window</span>
    </div>
    <div style="position:relative;height:180px"><canvas id="chart-daily" aria-label="Bar chart of daily repository additions with 7-day rolling average and linear growth trend" role="img"></canvas></div>
    <div class="daily-legend" aria-hidden="true">
      <div class="daily-leg-item"><div class="daily-leg-bar" style="background:rgba(249,115,22,0.25);border:1px solid #f97316"></div>new repos / day</div>
      <div class="daily-leg-item"><div class="daily-leg-line" style="background:var(--cyan)"></div>7-day avg</div>
      <div class="daily-leg-item"><div class="daily-leg-dash" style="border-color:rgba(249,115,22,0.6)"></div>growth trend</div>
    </div>
  </div>

  <!-- Repo index table -->
  <div class="section-divider" aria-hidden="true">
    <div class="sdl"><span class="sdl-slash">//</span> <span class="sdl-tag">featured_repo_index</span></div>
    <div class="sdl-line"></div>
    <div class="sdl-count" id="index-count">â€” featured picks</div>
  </div>

  <div class="table-wrap">
    <div class="table-scroll" role="region" aria-label="Repository index" tabindex="0">
      <table class="rtable" id="repo-table" aria-describedby="index-count">
        <caption class="sr-only">OpenClaw GitHub repositories. Click column headers to sort.</caption>
        <thead>
          <tr>
            <th scope="col" class="col-rank"><span class="sort-th-btn" style="padding:0.65rem 1rem;display:block">#</span></th>
            <th scope="col" class="col-repo">
              <span class="sort-th-btn" style="padding:0.65rem 1rem;display:block">Repository</span>
            </th>
            <th scope="col" class="col-stars" aria-sort="descending" id="th-stars">
              <button class="sort-th-btn active" onclick="sortTable('stars')" aria-label="Sort by stars, currently descending">
                Stars <span class="sort-arrow" aria-hidden="true" id="arr-stars">â†“</span>
              </button>
            </th>
            <th scope="col" class="col-lang" aria-sort="none" id="th-lang">
              <button class="sort-th-btn" onclick="sortTable('language')" aria-label="Sort by language">
                Language <span class="sort-arrow" aria-hidden="true" id="arr-language"></span>
              </button>
            </th>
            <th scope="col" class="col-topics" aria-sort="none" id="th-topics">
              <button class="sort-th-btn" onclick="sortTable('topic')" aria-label="Sort by first topic">
                Topics <span class="sort-arrow" aria-hidden="true" id="arr-topic"></span>
              </button>
            </th>
            <th scope="col" class="col-date" aria-sort="none" id="th-created">
              <button class="sort-th-btn" onclick="sortTable('created')" aria-label="Sort by created date">
                Created <span class="sort-arrow" aria-hidden="true" id="arr-created"></span>
              </button>
            </th>
            <th scope="col" class="col-link"><span class="sr-only">Link</span></th>
          </tr>
        </thead>
        <tbody id="repo-tbody">
          <tr><td colspan="7" class="empty-state">// loading indexâ€¦</td></tr>
        </tbody>
      </table>
    </div>
    <nav class="pagination" aria-label="Repository table pages" id="pagination-ctrl">
      <button class="page-btn" id="btn-prev" onclick="changePage(-1)" aria-label="Previous page" disabled>â† Prev</button>
      <span class="page-info" id="page-info" aria-live="polite">â€”</span>
      <button class="page-btn" id="btn-next" onclick="changePage(1)" aria-label="Next page" disabled>Next â†’</button>
    </nav>
  </div>

</main>

<!-- â”€â”€ FOOTER â”€â”€ -->
<footer class="footer">
  <div class="footer-inner">
    <div class="footer-brand">ClawBeat<span>.co</span></div>
  </div>
</footer>

<!-- Screen-reader-only utility -->
<style>.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}</style>

<script>
  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   *  CONFIG
   * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  const SUPABASE_URL  = 'https://twouuiapzrkezwbtylij.supabase.co';
  const SUPABASE_ANON = 'sb_publishable_j-AmOSIuQPEeKIyYAOA2Gg_8ekguDsG';
  const PAGE_SIZE     = 20;

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   *  SAMPLE FALLBACK DATA
   * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  /* Curated fallback â€” 15 repos scored â‰¥ 68 against the OpenClaw Evaluation Rubric v1.3 (2026-02-28) */
  const SAMPLE = [
    { id:1,  owner:'openclaw',          name:'openclaw',                    description:"Your own personal AI assistant. Any OS. Any Platform. The lobster way. ğŸ¦",                                                                           stars:240352, language:'TypeScript',  created_at:'2025-11-24', url:'https://github.com/openclaw/openclaw',                          topics:['ai','assistant','crustacean','molty','openclaw'],                           forks:46398, open_issues:9468, license:'MIT' },
    { id:2,  owner:'zhayujie',          name:'chatgpt-on-wechat',           description:"CowAgent â€” agentic AI assistant with long-term memory and Skills execution. Supports WeChat, DingTalk, Feishu, and more.",                          stars:41635,  language:'Python',      created_at:'2022-08-07', url:'https://github.com/zhayujie/chatgpt-on-wechat',                 topics:['ai','ai-agent','chatgpt','claude','openclaw'],                              forks:9780,  open_issues:352,  license:'MIT' },
    { id:3,  owner:'VoltAgent',         name:'awesome-openclaw-skills',     description:"The awesome collection of OpenClaw skills. 5,400+ skills filtered and categorized from the official OpenClaw Skills Registry. ğŸ¦",                 stars:23018,  language:'Undetected', created_at:'2026-01-25', url:'https://github.com/VoltAgent/awesome-openclaw-skills',          topics:['agent-skills','awesome','awesome-list','clawdbot-skill','openclaw-skills'], forks:2300,  open_issues:3,    license:'MIT' },
    { id:4,  owner:'CherryHQ',          name:'cherry-studio',               description:"AI productivity studio with smart chat, autonomous agents, and 300+ assistants. Unified access to frontier LLMs.",                                  stars:40414,  language:'TypeScript',  created_at:'2024-05-24', url:'https://github.com/CherryHQ/cherry-studio',                     topics:['ai-agent','claude-code','codex','openclaw','vibe-coding'],                  forks:3727,  open_issues:662,  license:'AGPL-3.0' },
    { id:5,  owner:'1Panel-dev',        name:'1Panel',                      description:"ğŸ”¥ Take full control of your VPS with 1Panel. Deploy OpenClaw in one click.",                                                                       stars:33744,  language:'Go',          created_at:'2022-07-19', url:'https://github.com/1Panel-dev/1Panel',                           topics:['1panel','clawdbot','docker','linux','openclaw'],                            forks:2989,  open_issues:415,  license:'GPL-3.0' },
    { id:6,  owner:'iOfficeAI',         name:'AionUi',                      description:"Free, local, open-source 24/7 Cowork app and OpenClaw for Gemini CLI, Claude Code, Codex, Qwen Code, and more.",                                   stars:17406,  language:'TypeScript',  created_at:'2025-08-07', url:'https://github.com/iOfficeAI/AionUi',                           topics:['ai','ai-agent','claude-code','clawd','openclaw'],                           forks:1329,  open_issues:158,  license:'Apache-2.0' },
    { id:7,  owner:'hesamsheikh',       name:'awesome-openclaw-usecases',   description:"A community collection of OpenClaw use cases for making life easier.",                                                                              stars:13196,  language:'Undetected', created_at:'2026-02-08', url:'https://github.com/hesamsheikh/awesome-openclaw-usecases',      topics:['awesome-list','clawdbot','moltbot','openclaw','openclaw-plugin'],           forks:1088,  open_issues:23,   license:'MIT' },
    { id:8,  owner:'langbot-app',       name:'LangBot',                     description:"Production-grade platform for building agentic IM bots. Supports Discord, Slack, WeChat, and more. OpenClaw compatible.",                           stars:15408,  language:'Python',      created_at:'2022-12-07', url:'https://github.com/langbot-app/LangBot',                        topics:['agent','dify','dingtalk','llm','openclaw'],                                 forks:1323,  open_issues:118,  license:'Apache-2.0' },
    { id:9,  owner:'kepano',            name:'obsidian-skills',             description:"Agent skills for Obsidian. Teach your agent to use Markdown, Bases, JSON Canvas, and use the CLI.",                                                 stars:11594,  language:'Undetected', created_at:'2026-01-02', url:'https://github.com/kepano/obsidian-skills',                     topics:['obsidian','skills','agent','markdown'],                                     forks:619,   open_issues:6,    license:'MIT' },
    { id:10, owner:'AstrBotDevs',       name:'AstrBot',                     description:"Agentic IM Chatbot infrastructure integrating IM platforms, LLMs, and plugins. OpenClaw-compatible alternative.",                                   stars:18344,  language:'Python',      created_at:'2022-12-08', url:'https://github.com/AstrBotDevs/AstrBot',                        topics:['agent','ai','chatbot','llm','mcp'],                                         forks:1385,  open_issues:535,  license:'AGPL-3.0' },
    { id:11, owner:'volcengine',        name:'OpenViking',                  description:"Open-source context database designed specifically for AI Agents such as OpenClaw. Unifies memory, retrieval, and state.",                          stars:4241,   language:'Python',      created_at:'2026-01-05', url:'https://github.com/volcengine/OpenViking',                      topics:['agent','agentic-rag','context-database','openclaw'],                        forks:324,   open_issues:30,   license:'Apache-2.0' },
    { id:12, owner:'badrisnarayanan',   name:'antigravity-claude-proxy',    description:"Proxy that exposes Antigravity-provided Claude/Gemini models for use in Claude Code and OpenClaw (ClawdBot).",                                      stars:2971,   language:'JavaScript',  created_at:'2025-12-19', url:'https://github.com/badrisnarayanan/antigravity-claude-proxy',   topics:['claude','claude-code','openclaw','proxy'],                                  forks:397,   open_issues:9,    license:'MIT' },
    { id:13, owner:'liyupi',            name:'ai-guide',                    description:"Comprehensive AI resource guide and Vibe Coding tutorial. Covers LLM selection, prompts, RAG, MCP, and OpenClaw ecosystem.",                       stars:8418,   language:'JavaScript',  created_at:'2025-02-13', url:'https://github.com/liyupi/ai-guide',                            topics:['ai','chatgpt','claude','mcp','openclaw'],                                   forks:899,   open_issues:6,    license:'' },
    { id:14, owner:'mnfst',             name:'manifest',                    description:"Smart LLM routing for OpenClaw. Cut costs up to 70% by automatically selecting the best model for each request.",                                   stars:3414,   language:'TypeScript',  created_at:'2022-09-27', url:'https://github.com/mnfst/manifest',                             topics:['llm','openclaw','router'],                                                  forks:160,   open_issues:10,   license:'MIT' },
    { id:15, owner:'BlockRunAI',        name:'ClawRouter',                  description:"Agent-native LLM router empowering OpenClaw â€” intelligent routing, fallback, and load balancing for multi-model setups.",                          stars:3719,   language:'TypeScript',  created_at:'2026-02-03', url:'https://github.com/BlockRunAI/ClawRouter',                      topics:['llm','openclaw','router','agent'],                                          forks:361,   open_issues:19,   license:'MIT' },
  ];

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   *  STATE
   * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  let allRepos    = [];
  let pinnedRepo  = null;
  let currentLang = 'ALL';
  let tablePage   = 1;
  let tableSort   = { col: 'stars', dir: 'desc' };
  let chartsInited = false;
  let chartWindow  = 7;
  let chartMonthly = null;
  let chartDaily   = null;

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   *  HELPERS
   * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  function esc(s) {
    return (s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
  }

  /* ISO or YYYY-MM-DD â†’ MM-DD-YYYY */
  function fmtDate(str) {
    if (!str) return 'â€”';
    try {
      const s = String(str).trim();
      if (/^\d{2}-\d{2}-\d{4}$/.test(s)) return s;
      const d = new Date(s.length === 10 ? s + 'T00:00:00' : s);
      if (isNaN(d)) return s;
      return `${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}-${d.getFullYear()}`;
    } catch { return str; }
  }

  function parseDate(str) {
    if (!str) return null;
    const s = String(str).trim();
    if (/^\d{2}-\d{2}-\d{4}$/.test(s)) {
      const [m,d,y] = s.split('-');
      return new Date(+y, +m-1, +d);
    }
    const d = new Date(s);
    return isNaN(d) ? null : d;
  }

  /* Normalize topics field (array or comma string) */
  function getTopics(r) {
    if (!r.topics) return [];
    if (Array.isArray(r.topics)) return r.topics.filter(Boolean);
    return String(r.topics).split(',').map(t => t.trim()).filter(Boolean);
  }

  function langClass(lang) {
    const aliases = {
      'C++':'cpp', 'C#':'csharp', 'Jupyter Notebook':'jupyter',
      'Bash':'bash', 'Shell':'shell',
      'Undetected':'undetected', '':'undetected',
    };
    if (aliases[lang] !== undefined) return aliases[lang] || 'undetected';
    return (lang||'undetected').toLowerCase().replace(/[^a-z]/g,'') || 'undetected';
  }

  function langBadge(lang) {
    return `<span class="badge badge-lang-${langClass(lang||'Undetected')}">${esc(lang||'Undetected')}</span>`;
  }

  function langDot(lang) {
    return `<span class="lang-dot dot-${langClass(lang)}" aria-hidden="true"></span>`;
  }

  /* Linear regression â€” returns predicted y values */
  function linReg(data) {
    const n = data.length;
    if (n < 2) return data.map(() => 0);
    const sumX  = data.reduce((s,_,i) => s+i, 0);
    const sumY  = data.reduce((s,v) => s+v, 0);
    const sumXY = data.reduce((s,v,i) => s+i*v, 0);
    const sumX2 = data.reduce((s,_,i) => s+i*i, 0);
    const denom = n*sumX2 - sumX*sumX;
    if (!denom) return data.map(() => sumY/n);
    const m = (n*sumXY - sumX*sumY) / denom;
    const b = (sumY - m*sumX) / n;
    return data.map((_,i) => Math.max(0, +(m*i + b).toFixed(3)));
  }

  /* 7-day rolling average */
  function rollingAvg(data, win=7) {
    return data.map((_, i) => {
      const sl = data.slice(Math.max(0, i-win+1), i+1);
      return +(sl.reduce((s,v)=>s+v,0)/sl.length).toFixed(3);
    });
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   *  PINNED REPO
   * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  function findPinned() {
    return allRepos.find(r => r.owner === 'openclaw' && r.name === 'openclaw')
      || allRepos.filter(r => (r.owner||'').toLowerCase() === 'openclaw')
                 .sort((a,b) => (b.stars||0)-(a.stars||0))[0]
      || null;
  }

  function isPinned(r) {
    return pinnedRepo && r.owner === pinnedRepo.owner && r.name === pinnedRepo.name;
  }

  function renderPinnedCard() {
    const r = pinnedRepo;
    if (!r) {
      document.getElementById('pinned-card').innerHTML = `<p style="font-family:var(--mono);font-size:var(--min-font);color:var(--text-3)">No pinned repository found.</p>`;
      return;
    }
    const topics = getTopics(r).slice(0,4).map(t=>`<span class="badge badge-topic">${esc(t)}</span>`).join('');
    document.getElementById('pinned-card').innerHTML = `
      <div class="pinned-left">
        <div class="pinned-name">
          <a href="${esc(r.url||'#')}" target="_blank" rel="noopener noreferrer"
             aria-label="View ${esc(r.owner)}/${esc(r.name)} on GitHub (opens in new tab)">
            <span class="owner-text">${esc(r.owner||'')}</span><span class="slash-text">/</span>${esc(r.name||'')}
          </a>
        </div>
        <p class="pinned-desc">${esc(r.description||'The core OpenClaw repository.')}</p>
        <div class="pinned-meta">
          <span class="pmeta">â— <strong>${esc(r.owner||'â€”')}</strong></span>
          <span class="pmeta">âŠ• created <strong>${fmtDate(r.created_at)}</strong></span>
          ${r.forks != null ? `<span class="pmeta">â‘‚ <strong>${r.forks.toLocaleString()}</strong> forks</span>` : ''}
          ${r.license ? `<span class="pmeta">â—ˆ <strong>${esc(r.license)}</strong></span>` : ''}
          ${topics ? `<span class="pmeta" style="gap:0.3rem">${topics}</span>` : ''}
        </div>
      </div>
      <div class="pinned-right">
        <div class="pinned-stars" aria-label="${(r.stars||0).toLocaleString()} stars">â˜… ${(r.stars||0).toLocaleString()}</div>
        <div class="pinned-badges">
          ${langBadge(r.language)}
          <span class="badge badge-public">â—‰ Public</span>
        </div>
        <a href="${esc(r.url||'#')}" class="btn-gh" target="_blank" rel="noopener noreferrer"
           aria-label="View openclaw/core on GitHub (opens in new tab)">â†’ GitHub</a>
      </div>`;
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   *  STATUS BAR + HERO STATS
   * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  function updateStatus() {
    const stars = allRepos.reduce((s,r)=>s+(r.stars||0), 0);
    const detectedLangs = new Set(allRepos.map(r=>r.language).filter(Boolean)).size;
    document.getElementById('intel-count').textContent = `${allRepos.length} repos in ecosystem`;
    document.getElementById('hero-stats').innerHTML = `
      <div class="hero-stat"><span>repos</span><strong class="val-orange">${allRepos.length}</strong></div>
      <div class="hero-stat"><span>total_stars</span><strong class="val-orange">${stars.toLocaleString()}</strong></div>
      <div class="hero-stat"><span>languages</span><strong class="val-cyan">${detectedLangs}</strong></div>
    `;
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   *  LANGUAGE FILTER TABS
   * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  function buildLangCounts() {
    const c = {};
    /* Count from featured_repo_index set (featured+listed when tiers exist) */
    const hasTiers = allRepos.some(r => r.rubric_tier);
    const base = hasTiers
      ? allRepos.filter(r => r.rubric_tier === 'featured' || r.rubric_tier === 'listed')
      : allRepos;
    for (const r of base) {
      const key = r.language || 'Undetected';
      c[key] = (c[key]||0) + 1;
    }
    return c;
  }

  function renderLangTabs() {
    const hasTiers  = allRepos.some(r => r.rubric_tier);
    const visibleN  = hasTiers
      ? allRepos.filter(r => r.rubric_tier === 'featured' || r.rubric_tier === 'listed').length
      : allRepos.length;
    const counts = buildLangCounts();
    let html = `<button class="filter-tab active" id="lang-ALL" onclick="setLang('ALL')"
                  aria-pressed="true">ALL <span class="tab-count">${visibleN}</span></button>`;
    for (const [lang, n] of Object.entries(counts)) {
      html += `<button class="filter-tab" id="lang-${esc(lang)}" onclick="setLang('${esc(lang)}')"
                 aria-pressed="false">${esc(lang)} <span class="tab-count">${n}</span></button>`;
    }
    document.getElementById('lang-tabs').innerHTML = html;
  }

  function setLang(l) {
    currentLang = l;
    tablePage   = 1;
    document.querySelectorAll('[id^="lang-"]').forEach(btn => {
      const active = btn.id === `lang-${l}`;
      btn.classList.toggle('active', active);
      btn.setAttribute('aria-pressed', active ? 'true' : 'false');
    });
    renderTable();
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   *  METRICS
   * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  function renderMetrics() {
    const total = allRepos.length;
    const stars = allRepos.reduce((s,r)=>s+(r.stars||0), 0);
    const avg   = total ? Math.round(stars/total) : 0;
    const langs = new Set(allRepos.map(r=>r.language).filter(Boolean)).size;
    document.getElementById('metrics-section').innerHTML = `
    <div class="metrics-row" role="list" aria-label="Ecosystem metrics">
      <div class="metric-chip" role="listitem">
        <div class="metric-label">// total_repos</div>
        <div class="metric-value mv-orange" aria-label="${total} total repositories">${total}</div>
        <div class="metric-sub">openclaw ecosystem</div>
      </div>
      <div class="metric-chip" role="listitem">
        <div class="metric-label">// total_stars</div>
        <div class="metric-value mv-orange" aria-label="${stars.toLocaleString()} total stars">${stars.toLocaleString()}</div>
        <div class="metric-sub">across all repos</div>
      </div>
      <div class="metric-chip" role="listitem">
        <div class="metric-label">// avg_stars</div>
        <div class="metric-value mv-cyan" aria-label="${avg.toLocaleString()} average stars per repository">${avg.toLocaleString()}</div>
        <div class="metric-sub">per repository</div>
      </div>
      <div class="metric-chip" role="listitem">
        <div class="metric-label">// languages</div>
        <div class="metric-value mv-green" aria-label="${langs} programming languages">${langs}</div>
        <div class="metric-sub">in index</div>
      </div>
    </div>`;
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   *  CHART.JS SHARED CONFIG
   * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  const LANG_COLORS = {
    Python:'#3b82f6', TypeScript:'#06b6d4', Rust:'#f97316',
    Go:'#22c55e', JavaScript:'#f59e0b', MDX:'#a78bfa',
    'C++':'#60a5fa', C:'#7dd3fc', 'C#':'#c084fc',
    Shell:'#4ade80', Bash:'#4ade80', Java:'#fb923c',
    Kotlin:'#e879f9', Swift:'#ff6b6b', Ruby:'#f43f5e',
    PHP:'#818cf8', Dockerfile:'#38bdf8', HTML:'#f87171',
    CSS:'#a78bfa', 'Jupyter Notebook':'#facc15',
    Undetected:'#3d4451',
  };
  /* Deterministic hue for any language not in the map */
  function lc(l) {
    if (LANG_COLORS[l]) return LANG_COLORS[l];
    let h = 0;
    for (let i = 0; i < (l||'').length; i++) h = (h * 31 + l.charCodeAt(i)) & 0xfffff;
    return `hsl(${h % 360}, 60%, 65%)`;
  }

  const TT = {
    backgroundColor:'#0d0f12', borderColor:'rgba(255,255,255,0.09)', borderWidth:1,
    titleColor:'#e2e4e9', bodyColor:'#9097a3',
    titleFont:{family:'JetBrains Mono',size:12}, bodyFont:{family:'JetBrains Mono',size:12},
  };
  const TICK_X = { color:'#6e7680', font:{family:'JetBrains Mono',size:12} };
  const TICK_Y = { color:'#6e7680', font:{family:'JetBrains Mono',size:12} };
  const GRID   = { color:'rgba(255,255,255,0.04)' };
  const BORDER = { color:'rgba(255,255,255,0.05)' };

  function initCharts() {
    if (chartsInited) return;
    chartsInited = true;

    /* â”€â”€ Stars â€” horizontal bar â”€â”€ */
    const top8 = [...allRepos].sort((a,b)=>(b.stars||0)-(a.stars||0)).slice(0,8);
    new Chart(document.getElementById('chart-stars'), {
      type: 'bar',
      data: {
        labels: top8.map(r=>`${r.owner}/${r.name}`),
        datasets: [{ label:'Stars', data:top8.map(r=>r.stars||0),
          backgroundColor:'rgba(249,115,22,0.2)', borderColor:'#f97316',
          borderWidth:1, borderRadius:3, barThickness:14 }],
      },
      options: {
        indexAxis:'y', responsive:true, maintainAspectRatio:false,
        plugins:{ legend:{display:false}, tooltip:{...TT, callbacks:{label:c=>` â˜… ${c.raw.toLocaleString()}`}} },
        scales:{
          x:{ grid:GRID, ticks:{...TICK_X,callback:v=>v>=1000?(v/1000).toFixed(0)+'k':v}, border:BORDER },
          y:{ grid:{display:false}, ticks:{...TICK_Y,font:{family:'JetBrains Mono',size:12}}, border:BORDER },
        },
      },
    });

    /* â”€â”€ Language doughnut â”€â”€ */
    const lc_counts = buildLangCounts();
    const ll = Object.keys(lc_counts), ld = Object.values(lc_counts);
    const lcolors = ll.map(l=>lc(l));
    new Chart(document.getElementById('chart-lang'), {
      type: 'doughnut',
      data: {
        labels: ll,
        datasets: [{ data:ld,
          backgroundColor:lcolors.map(c=>c+'28'), borderColor:lcolors,
          borderWidth:2, hoverBackgroundColor:lcolors.map(c=>c+'44') }],
      },
      options: {
        responsive:true, maintainAspectRatio:false, cutout:'62%',
        plugins:{
          legend:{ position:'bottom', labels:{color:'#9097a3',font:{family:'JetBrains Mono',size:12},padding:10,boxWidth:10,boxHeight:10} },
          tooltip:{...TT, callbacks:{label:c=>` ${c.raw} repo${c.raw!==1?'s':''}`}},
        },
      },
    });

    /* â”€â”€ Monthly bar (window-aware â€” populated by rebuildMonthlyChart) â”€â”€ */
    chartMonthly = new Chart(document.getElementById('chart-monthly'), {
      type: 'bar',
      data: { labels: [], datasets: [{ label:'Repos Created', data:[],
        backgroundColor:[], borderColor:[], borderWidth:1, borderRadius:2 }] },
      options: {
        responsive:true, maintainAspectRatio:false,
        plugins:{ legend:{display:false}, tooltip:{...TT, callbacks:{label:c=>` ${c.raw} repo${c.raw!==1?'s':''}`}} },
        scales:{
          x:{ grid:{display:false}, ticks:{...TICK_X,maxTicksLimit:14}, border:BORDER },
          y:{ grid:GRID, ticks:{...TICK_Y,stepSize:1,precision:0}, border:BORDER, min:0 },
        },
      },
    });

    /* â”€â”€ Daily bar + trend (window-aware â€” populated by rebuildDailyChart) â”€â”€ */
    chartDaily = new Chart(document.getElementById('chart-daily'), {
      type: 'bar',
      data: { labels: [], datasets: [
        { type:'bar',  label:'New repos / day', data:[],
          backgroundColor:'rgba(249,115,22,0.22)', borderColor:'#f97316',
          borderWidth:1, borderRadius:2, order:3 },
        { type:'line', label:'7-day avg', data:[],
          borderColor:'#06b6d4', backgroundColor:'transparent',
          borderWidth:2, pointRadius:0, tension:0.4, order:2 },
        { type:'line', label:'Growth trend', data:[],
          borderColor:'rgba(249,115,22,0.55)', backgroundColor:'transparent',
          borderWidth:1.5, borderDash:[5,4], pointRadius:0, tension:0, order:1 },
      ]},
      options: {
        responsive:true, maintainAspectRatio:false,
        interaction:{ mode:'index', intersect:false },
        plugins:{
          legend:{display:false},
          tooltip:{...TT, callbacks:{label: ctx => {
            if (ctx.dataset.label==='New repos / day') return ` ${ctx.raw} new repo${ctx.raw!==1?'s':''}`;
            if (ctx.dataset.label==='7-day avg')       return ` 7-day avg: ${ctx.raw.toFixed(2)}`;
            if (ctx.dataset.label==='Growth trend')    return ` trend: ${ctx.raw.toFixed(2)}`;
            return ` ${ctx.raw}`;
          }}},
        },
        scales:{
          x:{ grid:{display:false}, ticks:{...TICK_X,maxTicksLimit:15}, border:BORDER },
          y:{ grid:GRID, ticks:{...TICK_Y,stepSize:1,precision:0}, border:BORDER, min:0 },
        },
      },
    });

    rebuildMonthlyChart();
    rebuildDailyChart();
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   *  CHART WINDOW CONTROLS
   * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  function setWindow(n) {
    chartWindow = n;
    document.querySelectorAll('.win-tab').forEach(btn => {
      const active = +btn.dataset.days === n;
      btn.classList.toggle('active', active);
      btn.setAttribute('aria-pressed', active ? 'true' : 'false');
    });
    const note = document.getElementById('daily-win-note');
    if (note) note.textContent = n + '-day window';
    rebuildMonthlyChart();
    rebuildDailyChart();
  }

  function rebuildMonthlyChart() {
    if (!chartMonthly) return;
    const MONS   = ['JAN','FEB','MAR','APR','MAY','JUN','JUL','AUG','SEP','OCT','NOV','DEC'];
    const today  = new Date(); today.setHours(0,0,0,0);
    const cutoff = new Date(today); cutoff.setDate(cutoff.getDate() - chartWindow + 1);
    const mStart = new Date(cutoff.getFullYear(), cutoff.getMonth(), 1);
    const monthly = {};
    for (let d = new Date(mStart); d <= today; d.setMonth(d.getMonth()+1)) {
      monthly[`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}`] = 0;
    }
    for (const r of allRepos) {
      const dt = parseDate(r.created_at); if (!dt) continue;
      if (dt < cutoff) continue;
      const k = `${dt.getFullYear()}-${String(dt.getMonth()+1).padStart(2,'0')}`;
      if (k in monthly) monthly[k]++;
    }
    const mLabels = Object.keys(monthly).map(k=>{ const [y,m]=k.split('-'); return `${MONS[+m-1]} ${y.slice(2)}`; });
    const mData   = Object.values(monthly);
    chartMonthly.data.labels = mLabels;
    chartMonthly.data.datasets[0].data = mData;
    chartMonthly.data.datasets[0].backgroundColor = mData.map(v=>v>0?'rgba(249,115,22,0.22)':'rgba(255,255,255,0.02)');
    chartMonthly.data.datasets[0].borderColor      = mData.map(v=>v>0?'#f97316':'rgba(255,255,255,0.05)');
    chartMonthly.update();
  }

  function rebuildDailyChart() {
    if (!chartDaily) return;
    const today   = new Date(); today.setHours(0,0,0,0);
    const dLabels = [], dData = [];
    for (let i = chartWindow-1; i >= 0; i--) {
      const d = new Date(today); d.setDate(d.getDate()-i);
      dLabels.push(d.toISOString().slice(0,10));
      dData.push(0);
    }
    for (const r of allRepos) {
      const dt = parseDate(r.created_at); if (!dt) continue;
      dt.setHours(0,0,0,0);
      const key = dt.toISOString().slice(0,10);
      const idx = dLabels.indexOf(key);
      if (idx >= 0) dData[idx]++;
    }
    const rolling     = rollingAvg(dData, 7);
    const trend       = linReg(dData);
    const dispLabels  = dLabels.map(k => {
      const d = new Date(k+'T00:00:00');
      return `${String(d.getMonth()+1).padStart(2,'0')}/${String(d.getDate()).padStart(2,'0')}`;
    });
    chartDaily.data.labels = dispLabels;
    chartDaily.data.datasets[0].data = dData;
    chartDaily.data.datasets[1].data = rolling;
    chartDaily.data.datasets[2].data = trend;
    chartDaily.update();
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   *  TABLE SORT
   * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  function sortTable(col) {
    if (tableSort.col === col) {
      tableSort.dir = tableSort.dir === 'desc' ? 'asc' : 'desc';
    } else {
      tableSort = { col, dir: (col === 'stars' || col === 'created') ? 'desc' : 'asc' };
    }
    tablePage = 1;

    /* Update th aria-sort and button styles */
    const cols = ['stars','language','topic','created'];
    cols.forEach(c => {
      const th  = document.getElementById(`th-${c}`);
      const arr = document.getElementById(`arr-${c}`);
      const btn = th?.querySelector('.sort-th-btn');
      if (!th || !arr || !btn) return;
      if (c === tableSort.col) {
        th.setAttribute('aria-sort', tableSort.dir === 'asc' ? 'ascending' : 'descending');
        btn.classList.add('active');
        arr.textContent = tableSort.dir === 'asc' ? 'â†‘' : 'â†“';
        btn.setAttribute('aria-label', `Sort by ${c}, currently ${tableSort.dir === 'asc' ? 'ascending' : 'descending'}`);
      } else {
        th.setAttribute('aria-sort', 'none');
        btn.classList.remove('active');
        arr.textContent = '';
        btn.setAttribute('aria-label', `Sort by ${c}`);
      }
    });

    renderTable();
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   *  GET TABLE ROWS (filtered + sorted)
   * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  function getTableRepos() {
    let repos = allRepos.filter(r => !isPinned(r));
    /* featured_repo_index: always filter to featured+listed when tier data exists */
    const hasTiers = allRepos.some(r => r.rubric_tier);
    if (hasTiers) {
      repos = repos.filter(r => r.rubric_tier === 'featured' || r.rubric_tier === 'listed');
    }
    if (currentLang !== 'ALL') repos = repos.filter(r => r.language === currentLang);
    repos.sort((a, b) => {
      let av, bv;
      const ta = getTopics(a)[0] || '';
      const tb = getTopics(b)[0] || '';
      switch (tableSort.col) {
        case 'stars':    av = a.stars||0;       bv = b.stars||0;      break;
        case 'language': av = a.language||'';   bv = b.language||'';  break;
        case 'topic':    av = ta;               bv = tb;              break;
        case 'created':  av = parseDate(a.created_at)||new Date(0); bv = parseDate(b.created_at)||new Date(0); break;
        default:         av = a.stars||0;       bv = b.stars||0;
      }
      if (typeof av === 'string') return tableSort.dir==='asc' ? av.localeCompare(bv) : bv.localeCompare(av);
      return tableSort.dir==='asc' ? av-bv : bv-av;
    });
    return repos;
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   *  RENDER TABLE
   * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  function renderTable() {
    const repos  = getTableRepos();
    const total  = repos.length;
    const pages  = Math.max(1, Math.ceil(total / PAGE_SIZE));
    tablePage    = Math.min(tablePage, pages);
    const start  = (tablePage-1) * PAGE_SIZE;
    const page   = repos.slice(start, start + PAGE_SIZE);

    document.getElementById('index-count').textContent =
      `${total} ${currentLang === 'ALL' ? '' : currentLang + ' '}featured pick${total===1?'':'s'}`;

    const tbody = document.getElementById('repo-tbody');
    if (!page.length) {
      tbody.innerHTML = `<tr><td colspan="7" class="empty-state">// no repositories match this filter</td></tr>`;
    } else {
      tbody.innerHTML = page.map((r, i) => {
        const rank      = start + i + 1;
        const topics    = getTopics(r);
        const topicHTML = topics.slice(0,3).map(t=>`<span class="badge badge-topic">${esc(t)}</span>`).join('');
        const desc      = r.description || 'â€”';
        return `
        <tr>
          <td class="col-rank td-rank" aria-label="Rank ${rank}">${String(rank).padStart(2,'0')}</td>
          <td class="col-repo td-repo">
            ${langDot(r.language)}
            <a href="${esc(r.url||'#')}" target="_blank" rel="noopener noreferrer"
               aria-label="${esc(r.owner)}/${esc(r.name)} (opens GitHub in new tab)">
              <span class="td-owner-dim">${esc(r.owner||'')}/</span>${esc(r.name||'')}
            </a>
            ${desc !== 'â€”' ? `<span class="td-desc-inline" title="${esc(desc)}">${esc(desc)}</span>` : ''}
          </td>
          <td class="col-stars td-stars" aria-label="${(r.stars||0).toLocaleString()} stars">â˜… ${(r.stars||0).toLocaleString()}</td>
          <td class="col-lang">${langBadge(r.language)}</td>
          <td class="col-topics"><div class="td-topics">${topicHTML||'â€”'}</div></td>
          <td class="col-date td-date">${fmtDate(r.created_at)}</td>
          <td class="col-link td-link">
            <a href="${esc(r.url||'#')}" target="_blank" rel="noopener noreferrer" aria-label="Open ${esc(r.name)} on GitHub">
              <i data-lucide="external-link" aria-hidden="true"></i>
            </a>
          </td>
        </tr>`;
      }).join('');
      lucide.createIcons({ nodes: [tbody] });
    }

    /* Pagination controls */
    const btnPrev = document.getElementById('btn-prev');
    const btnNext = document.getElementById('btn-next');
    const info    = document.getElementById('page-info');
    const rangeEnd = Math.min(start + PAGE_SIZE, total);
    info.innerHTML = total
      ? `Page <em>${tablePage}</em> of <em>${pages}</em> Â· repos <em>${start+1}â€“${rangeEnd}</em> of <em>${total}</em>`
      : 'No results';
    btnPrev.disabled = tablePage <= 1;
    btnNext.disabled = tablePage >= pages;
  }

  function changePage(delta) {
    tablePage += delta;
    renderTable();
    /* Scroll table into view smoothly */
    document.querySelector('.table-wrap')?.scrollIntoView({ behavior:'smooth', block:'nearest' });
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   *  DATA FETCH â†’ RENDER
   * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  async function init() {
    try {
      const res = await fetch(
        `${SUPABASE_URL}/rest/v1/github_projects?select=*&limit=1000&order=stars.desc`,
        { headers: { apikey:SUPABASE_ANON, Authorization:`Bearer ${SUPABASE_ANON}` } }
      );
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const data = await res.json();
      allRepos = Array.isArray(data) && data.length ? data : SAMPLE;
    } catch {
      allRepos = SAMPLE;
    }

    pinnedRepo = findPinned();

    renderPinnedCard();
    updateStatus();
    renderMetrics();
    renderLangTabs();
    renderTable();

    requestAnimationFrame(() => { initCharts(); lucide.createIcons(); });
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   *  MOBILE MENU
   * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  function toggleMenu() {
    const menu      = document.getElementById('mobile-menu');
    const btn       = document.getElementById('hamburger-btn');
    const iconMenu  = document.getElementById('icon-menu');
    const iconClose = document.getElementById('icon-close');
    const open      = menu.classList.contains('open');
    menu.classList.toggle('open', !open);
    menu.setAttribute('aria-hidden', open ? 'true' : 'false');
    btn.setAttribute('aria-expanded', open ? 'false' : 'true');
    iconMenu.style.display  = open ? '' : 'none';
    iconClose.style.display = open ? 'none' : '';
  }

  /* Close mobile menu on Escape */
  document.addEventListener('keydown', e => {
    if (e.key === 'Escape' && document.getElementById('mobile-menu').classList.contains('open')) {
      toggleMenu();
      document.getElementById('hamburger-btn').focus();
    }
  });

  init();
  lucide.createIcons();
</script>
</body>
</html>
